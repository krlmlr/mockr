<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mocking with mockr • mockr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mocking with mockr">
<meta property="og:description" content="mockr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mockr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/mockr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/krlmlr/mockr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mockr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Mocking with mockr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/krlmlr/mockr/blob/master/vignettes/mockr.Rmd"><code>vignettes/mockr.Rmd</code></a></small>
      <div class="hidden name"><code>mockr.Rmd</code></div>

    </div>

    
    
<p>The mockr package helps testing code that relies on functions that are slow, have unintended side effects or access resources that may not be available when testing. It allows replacing such functions with deterministic <a href="https://en.wikipedia.org/wiki/Mock_object"><em>mock functions</em></a>. This article gives an overview and introduces a few techniques.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://krlmlr.github.io/mockr/">mockr</a></span><span class="op">)</span></code></pre></div>
<div id="general-idea" class="section level2">
<h2 class="hasAnchor">
<a href="#general-idea" class="anchor"></a>General idea</h2>
<p>Let’s assume a function <code>access_resource()</code> that accesses some resource. This works in normal circumstances, but not during tests. A function <code>work_with_resource()</code> works with that resource. How can we test <code>work_with_resource()</code> without adding too much logic to the implementation?</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">access_resource</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Trying to access resource..."</span><span class="op">)</span>
  <span class="co"># For some reason we can't access the resource in our tests.</span>
  <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Can't access resource now."</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">work_with_resource</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">resource</span> <span class="op">&lt;-</span> <span class="fu">access_resource</span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Fetched resource: "</span>, <span class="va">resource</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">resource</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In our example, calling the worker function gives an error:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">work_with_resource</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Trying to access resource...</span>
<span class="co">#&gt; Error in access_resource(): Can't access resource now.</span></code></pre></div>
<p>We can use <code><a href="../reference/local_mock.html">local_mock()</a></code> to temporarily replace the implementation of <code>access_resource()</code> with one that doesn’t throw an error:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">access_resource_for_test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># We return a value that's good enough for testing</span>
  <span class="co"># and can be computed quickly:</span>
  <span class="fl">42</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/eval.html">local</a></span><span class="op">(</span><span class="op">{</span>
  <span class="co"># Here, we override the function that raises the error</span>
  <span class="fu"><a href="../reference/local_mock.html">local_mock</a></span><span class="op">(</span>access_resource <span class="op">=</span> <span class="va">access_resource_for_test</span><span class="op">)</span>

  <span class="fu">work_with_resource</span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; Fetched resource: 42</span></code></pre></div>
<p>The use of <code><a href="https://rdrr.io/r/base/eval.html">local()</a></code> here is required for technical reasons. This package is most useful in conjunction with testthat, the remainder of this article will focus on that use case.</p>
</div>
<div id="create-demo-package" class="section level2">
<h2 class="hasAnchor">
<a href="#create-demo-package" class="anchor"></a>Create demo package</h2>
<p>We create a package called {mocktest} for demonstration. For this demo, the package is created in a temporary directory. A real project will live somewhere in your home directory. The <code><a href="https://usethis.r-lib.org/reference/create_package.html">usethis::create_package()</a></code> function sets up a package project ready for development. The output shows the details of the package created.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pkg</span> <span class="op">&lt;-</span> <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_package.html">create_package</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"mocktest"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Creating '/tmp/RtmpOc466f/mocktest/'</span>
<span class="co">#&gt; ✔ Setting active project to '/tmp/RtmpOc466f/mocktest'</span>
<span class="co">#&gt; ✔ Creating 'R/'</span>
<span class="co">#&gt; ✔ Writing 'DESCRIPTION'</span>
<span class="co">#&gt; Package: mocktest</span>
<span class="co">#&gt; Title: What the Package Does (One Line, Title Case)</span>
<span class="co">#&gt; Version: 0.0.0.9000</span>
<span class="co">#&gt; Authors@R (parsed):</span>
<span class="co">#&gt;     * First Last &lt;first.last@example.com&gt; [aut, cre] (YOUR-ORCID-ID)</span>
<span class="co">#&gt; Description: What the package does (one paragraph).</span>
<span class="co">#&gt; License: `use_mit_license()`, `use_gpl3_license()` or friends to pick a</span>
<span class="co">#&gt;     license</span>
<span class="co">#&gt; Encoding: UTF-8</span>
<span class="co">#&gt; LazyData: true</span>
<span class="co">#&gt; Roxygen: list(markdown = TRUE)</span>
<span class="co">#&gt; RoxygenNote: 7.0.0</span>
<span class="co">#&gt; ✔ Writing 'NAMESPACE'</span>
<span class="co">#&gt; ✔ Setting active project to '&lt;no active project&gt;'</span></code></pre></div>
<p>In an interactive RStudio session, a new window opens. Users of other environments would change the working directory manually. For this demo, we manually set the active project.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/proj_utils.html">proj_set</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ✔ Setting active project to '/tmp/RtmpOc466f/mocktest'</span></code></pre></div>
<p>The infrastructure files and directories that comprise a minimal R package are created:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="http://fs.r-lib.org/reference/dir_tree.html">dir_tree</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; .</span>
<span class="co">#&gt; ├── DESCRIPTION</span>
<span class="co">#&gt; ├── NAMESPACE</span>
<span class="co">#&gt; └── R</span></code></pre></div>
</div>
<div id="import-function" class="section level2">
<h2 class="hasAnchor">
<a href="#import-function" class="anchor"></a>Import function</h2>
<p>We copy the functions from the previous example (under different names) into the package. Normally we would use a text editor:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> R/resource.R <span class="op">&lt;&lt;"EOF"</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>access_resource_pkg &lt;- function() {</span>
<span id="cb8-3"><a href="#cb8-3"></a>  message("Trying to access resource...")</span>
<span id="cb8-4"><a href="#cb8-4"></a>  # For some reason we can't access the resource in our tests.</span>
<span id="cb8-5"><a href="#cb8-5"></a>  stop("Can't access resource now.")</span>
<span id="cb8-6"><a href="#cb8-6"></a>}</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a>work_with_resource_pkg &lt;- function() {</span>
<span id="cb8-9"><a href="#cb8-9"></a>  resource &lt;- access_resource_pkg()</span>
<span id="cb8-10"><a href="#cb8-10"></a>  message("Fetched resource: ", resource)</span>
<span id="cb8-11"><a href="#cb8-11"></a>  invisible(resource)</span>
<span id="cb8-12"><a href="#cb8-12"></a>}</span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="op">EOF</span></span></code></pre></div>
<p>Loading the package and calling the function gives the error we have seen before:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pkgload</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pkgload/man/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Loading mocktest</span>
<span class="fu">work_with_resource_pkg</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Trying to access resource...</span>
<span class="co">#&gt; Error in access_resource_pkg(): Can't access resource now.</span></code></pre></div>
</div>
<div id="adding-test-with-mock" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-test-with-mock" class="anchor"></a>Adding test with mock</h2>
<p>We create a test that tests <code>work_with_resource_pkg()</code>, mocking <code>access_resource_pkg()</code>. We need to prefix with the package name, because testthat provides its own <code><a href="https://testthat.r-lib.org/reference/with_mock.html">testthat::local_mock()</a></code> which is now deprecated.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_testthat.html">use_testthat</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ✔ Adding 'testthat' to Suggests field in DESCRIPTION</span>
<span class="co">#&gt; ✔ Setting Config/testthat/edition field in DESCRIPTION to '3'</span>
<span class="co">#&gt; ✔ Creating 'tests/testthat/'</span>
<span class="co">#&gt; ✔ Writing 'tests/testthat.R'</span>
<span class="co">#&gt; ● Call `use_test()` to initialize a basic test file and open it for editing.</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> tests/testthat/test-resource.R <span class="op">&lt;&lt;"EOF"</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>test_that("Can work with resource", {</span>
<span id="cb11-3"><a href="#cb11-3"></a>  mockr::local_mock(access_resource_pkg = function() {</span>
<span id="cb11-4"><a href="#cb11-4"></a>    42</span>
<span id="cb11-5"><a href="#cb11-5"></a>  })</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a>  expect_message(</span>
<span id="cb11-8"><a href="#cb11-8"></a>    expect_equal(work_with_resource_pkg(), 42)</span>
<span id="cb11-9"><a href="#cb11-9"></a>  )</span>
<span id="cb11-10"><a href="#cb11-10"></a>})</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="op">EOF</span></span></code></pre></div>
<p>The test succeeds:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_package.html">test_local</a></span><span class="op">(</span>reporter <span class="op">=</span> <span class="st">"location"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'testthat'</span>
<span class="co">#&gt; The following objects are masked from 'package:mockr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     local_mock, with_mock</span>
<span class="co">#&gt; Start test: Can work with resource</span>
<span class="co">#&gt;   test-resource.R:6:3 [success]</span>
<span class="co">#&gt;   test-resource.R:6:3 [success]</span>
<span class="co">#&gt; End test: Can work with resource</span></code></pre></div>
</div>
<div id="run-individual-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#run-individual-tests" class="anchor"></a>Run individual tests</h2>
<p>mockr is aware of testthat and will work even if executing the tests in the current session. This is especially handy if you want to troubleshoot single tests:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">test_that</span><span class="op">(</span><span class="st">"Can work with resource"</span>, <span class="op">{</span>
  <span class="fu">mockr</span><span class="fu">::</span><span class="fu"><a href="../reference/local_mock.html">local_mock</a></span><span class="op">(</span>access_resource_pkg <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
    <span class="fl">42</span>
  <span class="op">}</span><span class="op">)</span>

  <span class="fu">expect_message</span><span class="op">(</span>
    <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">work_with_resource_pkg</span><span class="op">(</span><span class="op">)</span>, <span class="fl">42</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; Test passed 🥳</span></code></pre></div>
</div>
<div id="write-wrapper-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#write-wrapper-functions" class="anchor"></a>Write wrapper functions</h2>
<p>mockr can only mock functions in the current package. To substitute implementations of functions in other packages, create wrappers in your package and use these wrappers exclusively.</p>
<p>The example below demonstrates a <code>d6()</code> function that is used to get the value of a random die throw. Instead of using <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> directly, this function uses <code>my_runif()</code> which wraps <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> R/runif.R <span class="op">&lt;&lt;"EOF"</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>my_runif &lt;- function(...) {</span>
<span id="cb14-3"><a href="#cb14-3"></a>  runif(...)</span>
<span id="cb14-4"><a href="#cb14-4"></a>}</span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>d6 &lt;- function() {</span>
<span id="cb14-7"><a href="#cb14-7"></a>  trunc(my_runif(1, 0, 6)) + 1</span>
<span id="cb14-8"><a href="#cb14-8"></a>}</span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="op">EOF</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pkgload</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pkgload/man/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Loading mocktest</span></code></pre></div>
<p>This allows testing the behavior of <code>d6()</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">test_that</span><span class="op">(</span><span class="st">"d6() works correctly"</span>, <span class="op">{</span>
  <span class="va">seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.32</span>, <span class="fl">5.4</span>, <span class="fl">5</span>, <span class="fl">2.99</span><span class="op">)</span>
  <span class="va">my_runif_mock</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span><span class="op">(</span><span class="va">seq</span> <span class="op">&lt;&lt;-</span> <span class="va">seq</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
    <span class="va">seq</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span>

  <span class="fu">mockr</span><span class="fu">::</span><span class="fu"><a href="../reference/local_mock.html">local_mock</a></span><span class="op">(</span>my_runif <span class="op">=</span> <span class="va">my_runif_mock</span><span class="op">)</span>

  <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">d6</span><span class="op">(</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">d6</span><span class="op">(</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span>
  <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">d6</span><span class="op">(</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span>
  <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">d6</span><span class="op">(</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; Test passed 😸</span></code></pre></div>
</div>
<div id="mock-s3-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#mock-s3-methods" class="anchor"></a>Mock S3 methods</h2>
<p>mockr cannot substitute implementations of S3 methods. To substitute methods for a class <code>"foo"</code>, implement a subclass and add new methods only for that subclass. The pillar package contains <a href="https://github.com/r-lib/pillar/blob/fd6376eca74e9748ed616c49f906529eaee68df9/tests/testthat/helper-unknown-rows.R">an example</a> where a class with changed behavior for <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code> and <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> for the sole purpose of testing.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://krlmlr.info">Kirill Müller</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
